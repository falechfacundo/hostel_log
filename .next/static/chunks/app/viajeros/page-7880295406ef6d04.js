(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{8740:function(e,s,a){Promise.resolve().then(a.bind(a,914))},905:function(e,s,a){"use strict";a.d(s,{Z:function(){return r}});let r=(0,a(9205).Z)("Backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z",key:"1ol0lm"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}],["path",{d:"M8 22v-6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v6",key:"1fr6do"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}]])},401:function(e,s,a){"use strict";a.d(s,{Z:function(){return r}});let r=(0,a(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},2369:function(e,s,a){"use strict";a.d(s,{Z:function(){return r}});let r=(0,a(9205).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},914:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return ee}});var r=a(7437),t=a(2265),n=a(9507),l=a(4438),i=a(9397),c=a(5805),d=a(2369),o=a(4449),u=a(1298),m=a(522),p=a(6557),x=a(5170),h=a(322),f=a(3032),g=a(8575),j=a(3966),v=a(6741),N=a(886),b=a(6718),y=a(420),w=a(1599),k=a(6840),C="Checkbox",[Z,E]=(0,j.b)(C),[A,R]=Z(C),z=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,name:n,checked:l,defaultChecked:i,required:c,disabled:d,value:o="on",onCheckedChange:u,form:m,...p}=e,[x,h]=t.useState(null),f=(0,g.e)(s,e=>h(e)),j=t.useRef(!1),b=!x||m||!!x.closest("form"),[y=!1,w]=(0,N.T)({prop:l,defaultProp:i,onChange:u}),C=t.useRef(y);return t.useEffect(()=>{let e=null==x?void 0:x.form;if(e){let s=()=>w(C.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[x,w]),(0,r.jsxs)(A,{scope:a,state:y,disabled:d,children:[(0,r.jsx)(k.WV.button,{type:"button",role:"checkbox","aria-checked":G(y)?"mixed":y,"aria-required":c,"data-state":D(y),"data-disabled":d?"":void 0,disabled:d,value:o,...p,ref:f,onKeyDown:(0,v.M)(e.onKeyDown,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,v.M)(e.onClick,e=>{w(e=>!!G(e)||!e),b&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),b&&(0,r.jsx)(q,{control:x,bubbles:!j.current,name:n,value:o,checked:y,required:c,disabled:d,form:m,style:{transform:"translateX(-100%)"},defaultChecked:!G(i)&&i})]})});z.displayName=C;var S="CheckboxIndicator",I=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,forceMount:t,...n}=e,l=R(S,a);return(0,r.jsx)(w.z,{present:t||G(l.state)||!0===l.state,children:(0,r.jsx)(k.WV.span,{"data-state":D(l.state),"data-disabled":l.disabled?"":void 0,...n,ref:s,style:{pointerEvents:"none",...e.style}})})});I.displayName=S;var q=e=>{let{control:s,checked:a,bubbles:n=!0,defaultChecked:l,...i}=e,c=t.useRef(null),d=(0,b.D)(a),o=(0,y.t)(s);t.useEffect(()=>{let e=c.current,s=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(d!==a&&s){let r=new Event("click",{bubbles:n});e.indeterminate=G(a),s.call(e,!G(a)&&a),e.dispatchEvent(r)}},[d,a,n]);let u=t.useRef(!G(a)&&a);return(0,r.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:null!=l?l:u.current,...i,tabIndex:-1,ref:c,style:{...e.style,...o,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function G(e){return"indeterminate"===e}function D(e){return G(e)?"indeterminate":e?"checked":"unchecked"}var M=a(401),P=a(6474);let V=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(z,{ref:s,className:(0,P.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...t,children:(0,r.jsx)(I,{className:(0,P.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(M.Z,{className:"h-3.5 w-3.5"})})})});V.displayName=z.displayName;var F=a(8930),T=a(905),_=a(1817);function O(e){let{onAddGroup:s,partnerId:a,partnerName:n}=e,[c,d]=(0,t.useState)([{name:"",backpack:!1}]),[u,m]=(0,t.useState)(!1),[p,x]=(0,t.useState)({}),g=e=>{let s=[...c];s.splice(e,1),d(s)},j=(e,s)=>{let a=[...c];a[e].name=s,d(a),s.trim()&&x(s=>{let a={...s};return delete a["member-".concat(e)],a})},v=e=>{let s=[...c];s[e].backpack=!s[e].backpack,d(s)},N=()=>{let e={};return 0===c.filter(e=>""!==e.name.trim()).length&&(e.members="Se requiere al menos un miembro en el grupo"),c.forEach((s,a)=>{!s.name.trim()&&a<3&&(e["member-".concat(a)]="Nombre requerido")}),x(e),0===Object.keys(e).length},b=async e=>{if(e.preventDefault(),!N()){l.A.error("Por favor corrige los errores del formulario");return}let r=c.filter(e=>""!==e.name.trim());if(0===r.length){l.A.error("Se requiere al menos un miembro en el grupo");return}m(!0);try{await s({people:r,partnerId:a}),d([{name:"",backpack:!1}]),x({})}catch(e){console.log("Error al crear grupo:",e)}finally{m(!1)}};return(0,r.jsx)("div",{children:(0,r.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[n&&(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Este grupo ser\xe1 asignado al partner:"," ",(0,r.jsx)("span",{className:"font-medium",children:n})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)(f._,{className:p.members?"text-red-500":"",children:["Miembros del Grupo",p.members&&(0,r.jsx)("span",{className:"ml-1 text-xs",children:"*"})]}),(0,r.jsxs)(o.z,{type:"button",onClick:()=>{d([...c,{name:"",backpack:!1}])},variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z,{className:"h-3.5 w-3.5"}),(0,r.jsx)("span",{children:"A\xf1adir"})]})]}),p.members&&(0,r.jsx)("p",{className:"text-red-500 text-xs mb-2",children:p.members}),(0,r.jsx)("div",{className:"space-y-4 max-h-[200px] overflow-y-auto pr-1",children:c.map((e,s)=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(h.I,{value:e.name,onChange:e=>j(s,e.target.value),placeholder:"Persona ".concat(s+1),className:"flex-1 ".concat(p["member-".concat(s)]?"border-red-500":"")}),(0,r.jsx)(o.z,{type:"button",onClick:()=>g(s),variant:"destructive",size:"icon",disabled:c.length<=1,className:"h-9 w-9 flex-shrink-0",children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})]}),p["member-".concat(s)]&&(0,r.jsx)("p",{className:"text-red-500 text-xs",children:p["member-".concat(s)]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 ml-1",children:[(0,r.jsx)(V,{id:"member-backpack-".concat(s),checked:e.backpack,onCheckedChange:()=>v(s)}),(0,r.jsxs)("label",{htmlFor:"member-backpack-".concat(s),className:"text-xs flex items-center cursor-pointer",children:[(0,r.jsx)(T.Z,{className:"h-3 w-3 mr-1 text-muted-foreground"}),"Tiene mochila"]})]})]},s))})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)(o.z,{type:"submit",className:"w-full",disabled:u,children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Creando..."]}):"Crear Grupo"})})]})})}function L(e){let{onAddIndividual:s}=e,[a,n]=(0,t.useState)(""),[c,d]=(0,t.useState)(!1),[u,m]=(0,t.useState)([]),[p,x]=(0,t.useState)(!1),g=async()=>{if(0===u.length){l.A.error("A\xf1ade al menos una persona");return}x(!0);try{for(let e of u)await s(e);m([])}catch(e){console.error(e)}finally{x(!1)}},j=e=>{let s=[...u];s.splice(e,1),m(s)};return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!a.trim()){l.A.error("El nombre es requerido");return}m([...u,{name:a.trim(),backpack:c}]),n(""),document.getElementById("personName").focus()},className:"space-y-3",children:[(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(f._,{htmlFor:"personName",children:"Nombre de la persona"}),(0,r.jsx)(h.I,{id:"personName",value:a,onChange:e=>n(e.target.value),placeholder:"Nombre de la persona",className:"w-full",autoFocus:!0})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(V,{id:"hasBackpack",checked:c,onCheckedChange:e=>d(!!e)}),(0,r.jsxs)("label",{htmlFor:"hasBackpack",className:"text-sm flex items-center cursor-pointer",children:[(0,r.jsx)(T.Z,{className:"h-4 w-4 mr-1 text-muted-foreground"}),"Tiene mochila"]})]}),(0,r.jsxs)(o.z,{type:"submit",size:"sm",className:"ml-auto",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4 mr-1"}),"A\xf1adir"]})]})]}),u.length>0&&(0,r.jsxs)("div",{className:"border rounded-md p-2",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium mb-2",children:["Personas a a\xf1adir (",u.length,"):"]}),(0,r.jsx)("ul",{className:"max-h-[200px] overflow-y-auto space-y-1",children:u.map((e,s)=>(0,r.jsxs)("li",{className:"flex justify-between items-center py-1 px-2 hover:bg-muted/50 rounded-sm text-sm",children:[(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("span",{className:"font-medium",children:e.name}),e.backpack&&(0,r.jsx)(T.Z,{className:"h-3.5 w-3.5 text-primary"})]})}),(0,r.jsxs)(o.z,{type:"button",variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>j(s),children:[(0,r.jsx)("span",{className:"sr-only",children:"Eliminar"}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-3.5 w-3.5",children:(0,r.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})]})]},s))})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)(o.z,{type:"button",className:"w-full",onClick:g,disabled:0===u.length||p,children:p?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Guardando..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(M.Z,{className:"h-4 w-4 mr-2"}),u.length>0?"Guardar ".concat(u.length," ").concat(1===u.length?"persona":"personas"):"Guardar personas"]})})})]})})}function U(e){let{person:s,onUpdate:a,disabled:n=!1}=e,[i,c]=(0,t.useState)(!1),[d,o]=(0,t.useState)((null==s?void 0:s.backpack)||!1),u=async()=>{try{c(!0);let e=!d;if(o(e),"function"==typeof a)await a({id:s.id,backpack:e});else throw Error("Update function is not provided or is invalid")}catch(e){o(d),console.error("Error toggling backpack:",e),l.A.error("Error al actualizar estado de mochila")}finally{c(!1)}};return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(V,{id:"backpack-".concat(s.id),checked:d,onCheckedChange:u,disabled:i||n,className:"h-4 w-4 rounded-sm data-[state=checked]:bg-blue-500"}),(0,r.jsxs)("label",{htmlFor:"backpack-".concat(s.id),className:"ml-2 text-sm flex items-center gap-1 cursor-pointer",children:[(0,r.jsx)(T.Z,{className:"h-3.5 w-3.5 ".concat(d?"text-blue-500":"text-muted-foreground")}),i?"Actualizando...":""]})]})}var B=a(3583),H=a(1047),K=a(8250),W=a(7240);function Y(e){let{individuals:s=[],isLoading:a=!1,onRemoveIndividual:t}=e,n=(0,m.q)(e=>e.updatePerson),l=e=>{if(!e)return"-";try{return(0,K.WU)(new Date(e),"dd/MM/yyyy",{locale:W.es})}catch(e){return"-"}};return a?(0,r.jsx)("div",{className:"text-center py-4",children:"Cargando personas..."}):0===s.length?(0,r.jsxs)("div",{className:"bg-muted/50 rounded-lg p-8 text-center",children:[(0,r.jsx)(d.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-2 text-lg font-medium",children:"No hay personas individuales"}),(0,r.jsx)("p",{className:"mt-1 text-muted-foreground",children:"Agrega personas individuales usando el formulario"})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Personas Individuales"}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsx)(B.Zb,{children:(0,r.jsx)(B.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:e.name||e.first_name||"Sin nombre"}),e.notes&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.notes}),(e.start_date||e.end_date)&&(0,r.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[(0,r.jsx)(H.Z,{className:"h-3 w-3 mr-1"}),(0,r.jsxs)("span",{children:[l(e.start_date)," -"," ",l(e.end_date)]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(U,{person:e,onUpdate:n}),(0,r.jsx)(o.z,{variant:"destructive",size:"icon",onClick:()=>t(e.id),children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})]})]})})},e.id))})]})}function $(e){let{isLoading:s=!1,groups:a,onDeleteGroup:n,onAddMember:l,onRemoveMember:i,onUpdatePerson:d}=e,u=(0,m.q)(e=>e.updatePerson),x=(0,m.q)(e=>e.deleteGroup),h=(0,m.q)(e=>e.addPersonToGroup),f=(0,m.q)(e=>e.removePersonFromGroup),g=(0,p.Z)(e=>e.groups),j=(0,p.Z)(e=>e.selectedPartner),v=(0,p.Z)(e=>e.individuals),[N,b]=(0,t.useState)({}),y=a||g,w=n||x,k=l||((e,s)=>{g.find(s=>s.id===e)&&h({groupId:e,personData:{...s,partnerId:null==j?void 0:j.id}})}),C=i||((e,s)=>{f({groupId:e,personId:s})}),Z=d||u,E=e=>{confirm("\xbfEst\xe1s seguro de eliminar el grupo?")&&(console.log("Eliminando grupo con ID:",e),w(e))},A=(e,s,a)=>{if(b(e=>({...e,[s]:!0})),confirm("\xbfQuieres eliminar a ".concat(a||"este miembro"," del grupo?")))try{C(e,s),setTimeout(()=>{b(e=>{let a={...e};return delete a[s],a})},300)}catch(e){console.error("Error removing member:",e),b(e=>{let a={...e};return delete a[s],a})}else b(e=>{let a={...e};return delete a[s],a})},R=(e,s)=>{if(!y.find(s=>s.id===e))return;let a=y.reduce((e,s)=>{var a;return e+((null===(a=s.people)||void 0===a?void 0:a.length)||0)},0)+(v?v.length:0),r=(null==j?void 0:j.size)||0;if(r>0&&a>=r){alert("No se pueden agregar m\xe1s personas. El socio ya tiene ".concat(a," personas asignadas de un l\xedmite de ").concat(r,"."));return}k(e,s)};return s?(0,r.jsx)("div",{className:"text-center py-4",children:"Cargando grupos..."}):0===y.length?(0,r.jsxs)("div",{className:"bg-muted/50 rounded-lg p-8 text-center",children:[(0,r.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-2 text-lg font-medium",children:"No hay grupos"}),(0,r.jsx)("p",{className:"mt-1 text-muted-foreground",children:"Crea un grupo usando el formulario"})]}):(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Grupos"}),(0,r.jsx)("div",{className:"space-y-4 grid gap-4 grid-cols-2",children:y.map(e=>{var s,a;return(0,r.jsxs)(B.Zb,{children:[(0,r.jsx)(B.Ol,{className:"pb-2",children:(0,r.jsxs)(B.ll,{className:"flex justify-between items-center",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("span",{className:"text-sm font-normal text-muted-foreground",children:[(null===(s=e.people)||void 0===s?void 0:s.length)||0," personas"]})}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)(o.z,{variant:"destructive",size:"icon",onClick:()=>E(e.id),children:(0,r.jsx)(F.Z,{className:"h-4 w-4"})})})]})}),(0,r.jsxs)(B.aY,{className:"p-4",children:[(0,r.jsxs)("form",{className:"mb-3 flex gap-2",onSubmit:s=>{s.preventDefault();let a=s.target.elements.name;R(e.id,{name:a.value}),a.value=""},children:[(0,r.jsx)("input",{name:"name",type:"text",placeholder:"Nombre del miembro...",className:"flex-1 px-3 py-2 border rounded-md",required:!0}),(0,r.jsx)("button",{type:"submit",className:"px-3 py-2 bg-blue-500 text-white rounded-md",children:"Agregar"})]}),(0,r.jsx)("div",{className:"space-y-2",children:(null===(a=e.people)||void 0===a?void 0:a.length)?(0,r.jsx)("div",{className:"divide-y",children:e.people.map(s=>(0,r.jsxs)("div",{className:(0,P.cn)("flex justify-between items-center py-3",N[s.id]&&"opacity-50"),children:[(0,r.jsx)("span",{children:s.name||"Sin nombre"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(U,{person:s,onUpdate:Z,disabled:N[s.id]}),(0,r.jsx)("button",{onClick:()=>A(e.id,s.id,s.name),className:"p-1 text-red-500 hover:bg-red-50 rounded",disabled:N[s.id],children:N[s.id]?(0,r.jsx)(_.Z,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]},s.id))}):(0,r.jsx)("p",{className:"text-gray-500 text-center py-2",children:"No hay miembros en este grupo"})})]})]},e.id)})})]})}let X=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("textarea",{className:(0,P.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s,...t})});X.displayName="Textarea";let J=(0,a(9205).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function Q(){let[e,s]=(0,t.useState)(""),[a,n]=(0,t.useState)([]),[i,d]=(0,t.useState)(!1),[x,h]=(0,t.useState)(!1),f=(0,m.q)(e=>e.createGroup),g=(0,p.Z)(e=>e.selectedPartner),j=e=>{let s=e.split("\n").map(e=>e.trim()),a=[],r=[];return s.forEach(e=>{""===e&&r.length>0?(a.push([...r]),r=[]):""!==e&&r.push(e)}),r.length>0&&a.push(r),a},v=async()=>{let a=j(e);if(0===a.length){l.A.error("No hay grupos para importar");return}h(!0);try{let e=0;for(let s of a){let a={notes:"".concat(s.length," personas"),people:s.map(e=>({name:e.trim()})),partnerId:g.id};await f(a),e++}s(""),n([]),d(!1),l.A.success("Importados ".concat(e," grupos con \xe9xito"))}catch(e){l.A.error("Error al importar grupos: ".concat(e.message))}finally{h(!1)}};return(0,r.jsxs)(u.Vq,{open:i,onOpenChange:d,children:[(0,r.jsx)(u.hg,{asChild:!0,children:(0,r.jsxs)(o.z,{className:"bg-fuchsia-pink-500 hover:bg-fuchsia-pink-600 gap-2",children:[(0,r.jsx)(J,{className:"h-4 w-4"}),"Importar desde Texto"]})}),(0,r.jsxs)(u.cZ,{className:"sm:max-w-[800px]",children:[(0,r.jsx)(u.fK,{children:(0,r.jsx)(u.$N,{children:"Importar Grupos desde Texto"})}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsx)("p",{children:"Instrucciones:"}),(0,r.jsxs)("ul",{className:"list-disc pl-4 space-y-1",children:[(0,r.jsx)("li",{children:"Una persona por l\xednea"}),(0,r.jsx)("li",{children:"L\xednea en blanco para separar grupos"})]})]}),(0,r.jsx)(X,{placeholder:"SONIA SERRAS ESTER FERNANDEZ JESUS RODRIGUEZ  MARIA BOIX GUILABERT TANIA MATO SANCHEZ",value:e,onChange:e=>{let a=e.target.value;s(a),n(j(a))},className:"h-[400px] font-mono"})]}),(0,r.jsxs)("div",{className:"border-l pl-4",children:[(0,r.jsx)("h3",{className:"font-medium mb-4",children:"Vista Previa:"}),(0,r.jsx)("div",{className:"space-y-4 max-h-[400px] overflow-y-auto",children:a.map((e,s)=>(0,r.jsxs)("div",{className:"border rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{className:"font-medium",children:["Grupo ",s+1]}),(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.length," personas)"]})]}),(0,r.jsx)("ul",{className:"text-sm space-y-1",children:e.map((e,s)=>(0,r.jsx)("li",{className:"text-gray-600",children:e},s))})]},s))})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)(o.z,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),(0,r.jsxs)(o.z,{onClick:v,disabled:!a.length||x,className:"bg-green-600 hover:bg-green-700 text-white",children:[x?(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Importar ",a.length," ",1===a.length?"Grupo":"Grupos"]})]})]})]})}function ee(){let[e,s]=(0,t.useState)({group:!1,individual:!1}),a=(0,p.Z)(e=>e.selectedPartner),h=(0,p.Z)(e=>e.groups),f=(0,p.Z)(e=>e.individuals);(0,x.K)(e=>e.selectedDate);let g=(0,m.q)(e=>e.isLoading),j=(0,m.q)(e=>e.createGroup),v=(0,m.q)(e=>e.deleteGroup),N=(0,m.q)(e=>e.createIndividual),b=(0,m.q)(e=>e.deleteIndividual),y=(0,m.q)(e=>e.updatePerson),w=(0,m.q)(e=>e.addPersonToGroup),k=(0,m.q)(e=>e.removePersonFromGroup),C=(0,t.useCallback)(async e=>{try{let r={...e,partnerId:null==a?void 0:a.id};await j(r),s(e=>({...e,group:!1})),l.A.success("Grupo creado exitosamente")}catch(e){l.A.error("Error al crear grupo: ".concat(e.message))}},[j,null==a?void 0:a.id]),Z=(0,t.useCallback)(async e=>{try{let r={...e,partnerId:null==a?void 0:a.id};await N(r),s(e=>({...e,individual:!1})),l.A.success("Persona creada exitosamente")}catch(e){l.A.error("Error al crear persona: ".concat(e.message))}},[N,null==a?void 0:a.id]),E=(0,t.useCallback)(e=>{window.confirm("\xbfEst\xe1s seguro que deseas eliminar este grupo?")&&v(e)},[v]),A=(0,t.useCallback)((e,s)=>{if(!h.find(s=>s.id===e)){l.A.error("Grupo no encontrado");return}w({groupId:e,personData:{...s,partnerId:null==a?void 0:a.id}})},[w,h,null==a?void 0:a.id]),R=(0,t.useCallback)((e,s)=>{k({groupId:e,personId:s})},[k]),z=(0,t.useCallback)(e=>{window.confirm("\xbfEst\xe1s seguro que deseas eliminar esta persona?")&&b(e)},[b]);return a?(0,r.jsx)(n.i,{children:(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-primary",children:"Gesti\xf3n de Viajeros"}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(u.Vq,{open:e.group,onOpenChange:e=>s(s=>({...s,group:e})),children:[(0,r.jsx)(u.hg,{asChild:!0,children:(0,r.jsxs)(o.z,{variant:"outline",className:"flex items-center gap-2",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"A\xf1adir Grupo"})]})}),(0,r.jsxs)(u.cZ,{className:"max-w-md",children:[(0,r.jsx)(u.fK,{children:(0,r.jsxs)(u.$N,{children:["A\xf1adir grupo a ",(null==a?void 0:a.name)||"partner"]})}),(0,r.jsx)("div",{className:"py-4",children:(0,r.jsx)(O,{onAddGroup:C,partnerId:null==a?void 0:a.id,partnerName:null==a?void 0:a.name})})]})]}),(0,r.jsxs)(u.Vq,{open:e.individual,onOpenChange:e=>s(s=>({...s,individual:e})),children:[(0,r.jsx)(u.hg,{asChild:!0,children:(0,r.jsxs)(o.z,{variant:"outline",className:"flex items-center gap-2",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)(d.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"A\xf1adir Personas"})]})}),(0,r.jsxs)(u.cZ,{children:[(0,r.jsx)(u.fK,{children:(0,r.jsxs)(u.$N,{children:["A\xf1adir personas a ",(null==a?void 0:a.name)||"partner"]})}),(0,r.jsx)("div",{className:"py-4",children:(0,r.jsx)(L,{onAddIndividual:Z})})]})]}),(0,r.jsx)(Q,{})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,r.jsx)("div",{children:(0,r.jsx)(Y,{individuals:f,isLoading:g,onRemoveIndividual:z})}),(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)($,{groups:h,isLoading:g,onDeleteGroup:E,onAddMember:A,onRemoveMember:R,onUpdatePerson:y})})]})]})})}):(0,r.jsx)(n.i,{children:(0,r.jsx)("div",{className:"flex justify-center items-center h-full p-8",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"No hay grupo seleccionado"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Selecciona o crea un grupo para gestionar viajeros"})]})})})}},9507:function(e,s,a){"use strict";a.d(s,{i:function(){return l}});var r=a(2265),t=a(9376),n=a(8688);function l(e){let{children:s}=e,{user:a,loading:l,isAuthenticated:i,init:c,refreshSession:d}=(0,n.t)(),[o,u]=(0,r.useState)(!1),m=(0,t.useRouter)();return((0,r.useEffect)(()=>{let e;return(async()=>{try{e=await c(),u(!0)}catch(e){console.error("Failed to initialize auth:",e);try{await d()}catch(e){console.error("Failed to refresh session:",e),m.push("/login")}}})(),()=>{e&&e.unsubscribe()}},[c,d,m]),(0,r.useEffect)(()=>{!o||l||i||m.push("/login")},[i,l,m,o]),l||!i)?null:s}},3583:function(e,s,a){"use strict";a.d(s,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return c}});var r=a(7437),t=a(2265),n=a(6474);let l=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...t})});l.displayName="Card";let i=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...t})});i.displayName="CardHeader";let c=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...t})});c.displayName="CardTitle";let d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a),...t})});d.displayName="CardDescription";let o=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",a),...t})});o.displayName="CardContent";let u=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",a),...t})});u.displayName="CardFooter"},1298:function(e,s,a){"use strict";a.d(s,{$N:function(){return h},Be:function(){return f},Vq:function(){return c},cN:function(){return x},cZ:function(){return m},fK:function(){return p},hg:function(){return d}});var r=a(7437),t=a(2265),n=a(9027),l=a(2489),i=a(6474);let c=n.fC,d=n.xz,o=n.h_;n.x8;let u=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(n.aV,{ref:s,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t})});u.displayName=n.aV.displayName;let m=t.forwardRef((e,s)=>{let{className:a,children:t,...c}=e;return(0,r.jsxs)(o,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(n.VY,{ref:s,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...c,children:[t,(0,r.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(l.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Cerrar"})]})]})]})});m.displayName=n.VY.displayName;let p=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};p.displayName="DialogHeader";let x=e=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};x.displayName="DialogFooter";let h=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(n.Dx,{ref:s,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...t})});h.displayName=n.Dx.displayName;let f=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(n.dk,{ref:s,className:(0,i.cn)("text-sm text-muted-foreground",a),...t})});f.displayName=n.dk.displayName},322:function(e,s,a){"use strict";a.d(s,{I:function(){return l}});var r=a(7437),t=a(2265),n=a(6474);let l=t.forwardRef((e,s)=>{let{className:a,type:t,...l}=e;return(0,r.jsx)("input",{type:t,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...l})});l.displayName="Input"},3032:function(e,s,a){"use strict";a.d(s,{_:function(){return d}});var r=a(7437),t=a(2265),n=a(6394),l=a(535),i=a(6474);let c=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(n.f,{ref:s,className:(0,i.cn)(c(),a),...t})});d.displayName=n.f.displayName},6394:function(e,s,a){"use strict";a.d(s,{f:function(){return i}});var r=a(2265),t=a(6840),n=a(7437),l=r.forwardRef((e,s)=>(0,n.jsx)(t.WV.label,{...e,ref:s,onMouseDown:s=>{var a;s.target.closest("button, input, select, textarea")||(null===(a=e.onMouseDown)||void 0===a||a.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));l.displayName="Label";var i=l},6718:function(e,s,a){"use strict";a.d(s,{D:function(){return t}});var r=a(2265);function t(e){let s=r.useRef({value:e,previous:e});return r.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}}},function(e){e.O(0,[172,863,807,925,611,971,117,744],function(){return e(e.s=8740)}),_N_E=e.O()}]);