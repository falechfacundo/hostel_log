"use strict";exports.id=218,exports.ids=[218],exports.modules={9613:(r,e,s)=>{s.d(e,{i:()=>n});var t=s(7577),a=s(5047),o=s(5571);function n({children:r}){let{user:e,loading:s,isAuthenticated:n,init:l,refreshSession:i}=(0,o.t)(),[d,c]=(0,t.useState)(!1);return((0,a.useRouter)(),s||!n)?null:r}},809:(r,e,s)=>{s.d(e,{Ol:()=>l,SZ:()=>d,Zb:()=>n,aY:()=>c,eW:()=>g,ll:()=>i});var t=s(326),a=s(7577),o=s(1175);let n=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...e}));n.displayName="Card";let l=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...e}));l.displayName="CardHeader";let i=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("font-semibold leading-none tracking-tight",r),...e}));i.displayName="CardTitle";let d=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("text-sm text-muted-foreground",r),...e}));d.displayName="CardDescription";let c=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("p-6 pt-0",r),...e}));c.displayName="CardContent";let g=a.forwardRef(({className:r,...e},s)=>t.jsx("div",{ref:s,className:(0,o.cn)("flex items-center p-6 pt-0",r),...e}));g.displayName="CardFooter"},357:(r,e,s)=>{s.d(e,{m:()=>n});var t=s(8408),a=s(2867),o=s(5999);let n=(0,t.U)((r,e)=>({partnerAssignments:{},allAssignments:{},isLoading:!1,error:null,fetchPartnerAssignments:async(e,s)=>{if(!e||!s)return[];try{r({isLoading:!0,error:null});let{data:t,error:o}=await a.O.from("hostel_partner_assignments").select("*, hostel:hostels(*)").eq("partner_id",e).eq("date",s);if(o)throw Error(`Error fetching assignments: ${o.message}`);let n=`${e}-${s}`;return r(r=>({partnerAssignments:{...r.partnerAssignments,[n]:t||[]},isLoading:!1})),t||[]}catch(e){throw console.error("Error in fetchPartnerAssignments:",e),r({error:e.message,isLoading:!1}),e}},fetchAllAssignments:async e=>{if(!e)return[];try{r({isLoading:!0,error:null});let{data:s,error:t}=await a.O.from("hostel_partner_assignments").select(`
          *,
          hostel:hostels(*),
          partner:partners(id, name, size)
        `).eq("date",e);if(t)throw Error(`Error fetching all assignments: ${t.message}`);return r(r=>({allAssignments:{...r.allAssignments,[e]:s||[]},isLoading:!1})),s||[]}catch(e){throw console.error("Error in fetchAllAssignments:",e),r({error:e.message,isLoading:!1}),e}},addHostelAssignment:async(s,t,n)=>{if(!s||!t||!n)throw Error("Partner ID, hostel ID, and date are required");try{let l=(e().allAssignments[n]||[]).find(r=>r.hostel_id===t&&!r.id.toString().startsWith("temp-"));if(l){let r=l.partner?.name||"otro partner";throw Error(`Este albergue ya est\xe1 asignado a ${r} hoy`)}r({isLoading:!0,error:null});let{data:i,error:d}=await a.O.from("hostel_partner_assignments").insert({partner_id:s,hostel_id:t,date:n}).select("*, hostel:hostels(*)").single();if(d)throw Error(`Error creating assignment: ${d.message}`);let c=`${s}-${n}`;return r(r=>{let e=r.partnerAssignments[c]||[],t={...r.partnerAssignments,[c]:[...e,i]},a=r.allAssignments[n]||[],o={...r.allAssignments,[n]:[...a,{...i,partner:{id:s,name:"Partner actualizado"}}]};return{partnerAssignments:t,allAssignments:o,isLoading:!1}}),o.A.success("Albergue asignado correctamente"),i}catch(e){throw console.error("Error in addHostelAssignment:",e),r({error:e.message,isLoading:!1}),o.A.error(`Error al asignar albergue: ${e.message}`),e}},removeHostelAssignment:async s=>{try{let t=Object.values(e().allAssignments).flat().find(r=>r.id===s);if(!t)throw Error("Assignment not found");r({isLoading:!0,error:null});let{error:n}=await a.O.from("hostel_partner_assignments").delete().eq("id",s);if(n)throw Error(`Error removing assignment: ${n.message}`);let l=t.partner_id,i=t.date,d=`${l}-${i}`;return r(r=>{let e={...r.partnerAssignments};e[d]&&(e[d]=e[d].filter(r=>r.id!==s));let t={...r.allAssignments};return t[i]&&(t[i]=t[i].filter(r=>r.id!==s)),{partnerAssignments:e,allAssignments:t,isLoading:!1}}),o.A.success("Asignaci\xf3n eliminada correctamente"),{id:s}}catch(e){throw console.error("Error in removeHostelAssignment:",e),r({error:e.message,isLoading:!1}),o.A.error(`Error al eliminar asignaci\xf3n: ${e.message}`),e}},getPartnerAssignments:(r,s)=>{if(!r||!s)return[];let t=`${r}-${s}`;return e().partnerAssignments[t]||[]},isHostelAssigned:(r,s)=>(e().allAssignments[s]||[]).some(e=>e.hostel_id===r),getPartnerForHostel:(r,s)=>{let t=e().allAssignments[s]||[];return t.find(e=>e.hostel_id===r)?.partner||null},resetError:()=>r({error:null})}))},4389:(r,e,s)=>{s.d(e,{_:()=>c});var t=s(8408),a=s(5999);s(5424);var o=s(6242),n=(0,o.$)("f55caeec1617cf79b9f2eb056e11463b8cbb4a02"),l=(0,o.$)("229fa677a20f148a8603de39dd9331cee94983bf"),i=(0,o.$)("037b7e861bc6ea420d66cf150cb69da0c518156f"),d=(0,o.$)("6dd04356cf656044f11609b065047b9f93a65df9");let c=(0,t.U)((r,e)=>({hostels:[],isLoading:!1,error:null,fetchHostels:async()=>{try{r({isLoading:!0,error:null});let e=await l();if(e.error)throw Error(e.error);return r({hostels:e.hostels||[],isLoading:!1}),e.hostels||[]}catch(e){throw console.error("Error in fetchHostels:",e),r({error:e.message,isLoading:!1}),a.A.error(`Error al cargar albergues: ${e.message}`),e}},addHostel:async e=>{try{r({isLoading:!0,error:null});let s=await i(e);if(s.error)throw Error(s.error);return r(r=>({hostels:[...r.hostels,s.hostel],isLoading:!1})),a.A.success(`Albergue "${e.name}" creado correctamente`),s.hostel}catch(e){throw console.error("Error in addHostel:",e),r({error:e.message,isLoading:!1}),a.A.error(`Error al crear albergue: ${e.message}`),e}},updateHostel:async(e,s)=>{try{r({isLoading:!0,error:null});let t=await d(e,s);if(t.error)throw Error(t.error);return r(r=>({hostels:r.hostels.map(r=>r.id===e?t.hostel:r),isLoading:!1})),a.A.success("Albergue actualizado correctamente"),t.hostel}catch(e){throw console.error("Error in updateHostel:",e),r({error:e.message,isLoading:!1}),a.A.error(`Error al actualizar albergue: ${e.message}`),e}},deleteHostel:async s=>{try{r({isLoading:!0,error:null});let t=e().hostels.find(r=>r.id===s);if(!t)throw Error("Hostel not found");let o=await n(s);if(o.error)throw Error(o.error);return r(r=>({hostels:r.hostels.filter(r=>r.id!==s),isLoading:!1})),a.A.success(`Albergue "${t.name}" eliminado correctamente`),{id:s}}catch(e){throw console.error("Error in deleteHostel:",e),r({error:e.message,isLoading:!1}),a.A.error(`Error al eliminar albergue: ${e.message}`),e}},getHostelById:r=>e().hostels.find(e=>e.id===r)||null,resetError:()=>r({error:null})}))},1986:(r,e,s)=>{s.r(e),s.d(e,{addHostel:()=>n,deleteHostel:()=>i,fetchHostels:()=>o,updateHostel:()=>l});var t=s(7745);s(6461);var a=s(2177);async function o(){return(0,a.xO)(async r=>{try{return{hostels:await (0,a.qJ)(r,"hostels",{columns:"*, rooms(*)",order:{column:"name"}})||[],status:200}}catch(r){throw console.error("Error in fetchHostels server action:",r),r}})}async function n(r){return withAuth(async(r,e)=>{try{return{hostel:{...await (0,a.hE)(r,"hostels",e),rooms:[]},status:200}}catch(r){throw console.error("Error in addHostel server action:",r),r}},r)}async function l(r,e){return withAuth(async(r,e,s)=>{try{return{hostel:await (0,a.aM)(r,"hostels",s,{id:e},{single:!0}),status:200}}catch(r){throw console.error("Error in updateHostel server action:",r),r}},r,e)}async function i(r){return withAuth(async(r,e)=>{try{return await (0,a.ZI)(r,"hostels",{id:e}),{id:e,success:!0,status:200}}catch(r){throw console.error("Error in deleteHostel server action:",r),r}},r)}(0,s(8387).h)([o,n,l,i]),(0,t.j)("229fa677a20f148a8603de39dd9331cee94983bf",o),(0,t.j)("037b7e861bc6ea420d66cf150cb69da0c518156f",n),(0,t.j)("6dd04356cf656044f11609b065047b9f93a65df9",l),(0,t.j)("f55caeec1617cf79b9f2eb056e11463b8cbb4a02",i)},3881:(r,e,s)=>{s.r(e),s.d(e,{default:()=>a});var t=s(6621);let a=r=>[{type:"image/x-icon",sizes:"256x181",url:(0,t.fillMetadataSegment)(".",r.params,"favicon.ico")+""}]}};